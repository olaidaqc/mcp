# MCP AI       设计

日期：2026-02-19

## 1. 背景与目标
- 现有页面为静态展示，无法执行系统命令。
- 需要真实可交互：执行命令、实时日志、配置编辑。
- 关注 AI 插件/工具：可视化展示、唯一领域归属、更新提示。
- 必须本地运行、无 token、可持续更新。
- 允许联网仅用于公开目录信息（走代理 `http://127.0.0.1:10808`）。

## 2. 方案选择
采用“共享后端 + Web 控制台 + TUI 兜底”方案。
- Web：实时可视化与编辑。
- TUI：终端稳定入口。
- 共享后端：统一命令执行与扫描能力。

## 3. 架构
- 后端（Python）：命令执行、配置读写、扫描、日志、SSE 实时推送。
- Web UI：状态、日志、配置编辑、AI 工具/插件展示与推荐。
- TUI：命令执行、关键配置查看/编辑、日志浏览。

## 4. 核心组件
1. Command Runner
- 执行 `.bat/.sh/CLI` 命令，支持超时与退出码。
- 日志统一写入 `runtime.log`。

2. Config Manager
- 读写：
  - `~/.claude/mcp-config.json`
  - `~/.vscode/settings.json`
  - `~/.vscode/keybindings.json`
  - `web_mcp_manager/config/commands.json`
  - `web_mcp_manager/config/tool_rules.json`
  - `web_mcp_manager/config/scan_schedule.json`

3. AI Tools Scanner
- 本机扫描：VSCode 插件、pip、npm、winget（仅 AI 相关）。
- 在线扫描：VSCode Marketplace、PyPI、npm、winget/GitHub 公开信息。
- 不自动升级，仅提示更新与替代。

4. Realtime Hub
- SSE 推送状态/日志到 Web。
- TUI 轮询或轻量订阅，保持稳定。

5. File Organizer
- 扫描 `~/my-skills/`。
- 自动分类（脚本/配置/日志/说明/报告）。
- 可视化树形结构，支持移动/重命名。

## 5. 领域分类与推荐
- 每个工具/插件只能归属一个领域（唯一归属）。
- 默认领域：
  - 编程/开发
  - 内容写作/文案
  - 数据分析/科研
  - 图像/多媒体
  - 自动化/命令行
  - 通用/未分类
- 推荐逻辑（可配置权重）：更新活跃度、评分/用户量、成本（免费优先）、本机可用性。
- 推荐只在所属领域展示，避免跨域混乱。

## 6. 检测与健康检查
- 命令健康检查（失败/超时/退出码）。
- 配置校验（JSON/路径/依赖）。
- 维护状态异常（长期未更新/弃用）。

## 7. 实时与交互
- Web：SSE 实时日志与状态刷新。
- Web 可直接编辑配置、规则、命令。
- TUI 提供菜单与快捷键执行。
- 支持前端热更新（保存后自动刷新）。

## 8. 持续更新与同步
- 定期扫描（默认每天，可改）。
- 变更日志记录。
- 可选自动同步 GitHub（默认开）。

## 9. 非目标
- 不自动更新/替换工具。
- 不接入任何 LLM API（零 token 消耗）。

## 10. 测试
- 扫描器输出格式与规则测试。
- 命令执行器异常/超时测试。
- Web API 与 TUI 基础联通测试。

## 11. 交付标准
- 可直接运行。
- 数据真实、可交互、可执行。
- 有日志、可错误提示。
- 满足可视化、分类、推荐、定期检测要求。
